<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Carrito de Compras</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="container py-5">
  <h1 class="mb-4"><i class="fas fa-shopping-cart"></i> Carrito de Compras</h1>

  <div id="carritoContainer"></div>



  <div class="mt-4 d-flex justify-content-between">
    <a href="main.html" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Seguir comprando
    </a>

    <button class="btn btn-primary" onclick="vaciarCarrito()">
  <i class="fas fa-trash-alt"></i> Vaciar carrito
</button>



    <a href="../html/identificacion.html" class="btn btn-success">
  <i class="fas fa-credit-card"></i> Proceder al pago
</a>


  <script>
    function mostrarCarrito() {
      const carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      const container = document.getElementById("carritoContainer");
      container.innerHTML = "";

      if (carrito.length === 0) {
        container.innerHTML = `<div class="alert alert-info">Tu carrito está vacío.</div>`;
        return;
      }

      let total = 0;
      const table = document.createElement("table");
      table.className = "table table-bordered table-hover align-middle";
      table.innerHTML = `
        <thead class="table-dark">
          <tr>
            <th>Imagen</th>
            <th>Producto</th>
            <th>Precio (S/.)</th>
            <th>Cantidad</th>
            <th>Subtotal (S/.)</th>
            <th>Eliminar</th>
          </tr>
        </thead>
        <tbody></tbody>
      `;

      const tbody = table.querySelector("tbody");

      carrito.forEach((producto, index) => {
        const subtotal = producto.precio * producto.cantidad;
        total += subtotal;

        const fila = document.createElement("tr");
        fila.innerHTML = `
          <td><img src="${producto.imagen}" alt="${producto.nombre}" width="80" class="img-fluid rounded"></td>
          <td>${producto.nombre}</td>
          <td>S/.${producto.precio.toFixed(2)}</td>
          <td>${producto.cantidad}</td>
          <td>S/.${subtotal.toFixed(2)}</td>
          <td>
            <button class="btn btn-sm btn-danger" onclick="eliminarProducto(${index})">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        `;
        tbody.appendChild(fila);
      });

      const filaTotal = document.createElement("tr");
      filaTotal.innerHTML = `
        <td colspan="4" class="text-end fw-bold">Total:</td>
        <td colspan="2" class="fw-bold">S/.${total.toFixed(2)}</td>
      `;
      tbody.appendChild(filaTotal);

      container.appendChild(table);
    }

    function eliminarProducto(index) {
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      carrito.splice(index, 1);
      localStorage.setItem("carrito", JSON.stringify(carrito));
      mostrarCarrito();
    }

    document.addEventListener("DOMContentLoaded", mostrarCarrito);

    function vaciarCarrito() {
  if (confirm("¿Estás seguro de que deseas vaciar el carrito?")) {
    localStorage.removeItem("carrito");
    mostrarCarrito();
  }
}
  </script>
</body>

</html>